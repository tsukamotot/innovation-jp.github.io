= 安いCNCで生基板を掘削してみる
:published_at: 2017-04-29
:hp-alt-title: I drill dough with cheap CNC I bought at AliExpress
:hp-tags: KatoK,CNC,CNC1610,bCNC,Inkscape
:hp-image: kato/8/33.png

こんにちは。 +
弊社に3Dプリンターが来てから、モノ作り欲が高まっている加藤です。 +
PCの画面上で動作するものも良いですが、出来上がったものを実際に手にとって見れる良さは格別です。 +
本日は、勢いで買ってしまったCNCで生基板を削ってみる実験をしてみます。 +
 +
(なお、本記事の実践は自己責任の上お願いします。怪我・事故など起きても責任は負いかねます。) +


## 買ったもの
CNCは、AliExpressで探しました。 +
購入のポイントは、 +

* 安い
* 構造がシンプル(最低限の構成になっていて、勉強材料になる)
* 作業領域は小さくて良い
* AliExpressでの評価が高く、購入者数が多い

としました。 +
検討の結果、送料込みで約20,000円のCNC1610+ER11スピンドルの下記の商品を購入しました。

2017年4月29日現在、商品ページを確認した所、何やらセール中で少し安くなっているようです。 +


image::kato/8/01.png[]


## 注文から受取

注文から受取まで、9日でした。 +
AliExpressで注文すると受取まで1ヶ月以上かかる場合もあったので、9日で到着はかなり早い感じがします。 

* 2017年4月9日 注文
* 2017年4月13日 発送
* 2017年4月18日 受取

image::kato/8/02.png[]


## 開封
テープでぐるぐる巻きの箱が届きました。

image::kato/8/03.png[]

箱を開けると、２段に分かれていて、 +
１段目はこんな感じ。

image::kato/8/04.jpg[]

２段めはこんな感じ。

image::kato/8/05.jpg[]


部品を広げると、こんな感じです。

image::kato/8/06.png[]

3Dプリンターで出力したと思われる部品もありました。 +
表面がボコボコしている上に、若干出力に失敗しているようなのですが、大丈夫なんだろうか・・・

image::kato/8/07.jpg[]

コントローラーはこんな感じ。 +
AVRマイコンは、ATMEGA328P-AU  +
シリアル通信は、CH340G +
ステッピングモーター制御は、4988ET +
でした。

image::kato/8/08.jpg[]


ここで、ER11スピンドルが同封されていないことに気づき、ストアーに連絡を取ることに。。。

AliExpressのメッセージで、 +

```
私　「荷物が届いたけど、ER11スピンドルが同封されてませんでした。追加で送ってください（上記の部品を広げた写真を添付）」 
```
とメッセージを送った所、土曜日にも関わらず5時間後に +
```
ストア　「OK 、分かりました。申し訳ございません。お詫びにドリルを10本付け、配送しました。トラッキングナンバーはxxxxxxxxです」 
```
と返答がありました。 +

早い！悪くないサポートです。


## 組み立て
ER11スピンドルはまだ手元にありませんが、気を取り直して組み立てを行います。 +
組み立ては、付属CD内のマニュアルに沿って行います。 +
組み立てを行うにあたって、下記のウェブサイトを参考にさせていただきました。 +
非常にわかりやすく、参考になりました。 +

みら太な日々 - 基板加工機 その２ +
http://mirata.blogspot.jp/2016/12/blog-post_18.html +


組み立ては、サイズを測ってネジを締める作業になります。 +

こんな感じのパーツをひたすら作り、枠を作ります。 +

```
(注意）
下記の写真にはありませんが、スペーサーを入れる必要があります。
私はこれに気づかず、スペーサーを入れずに組み立て終わってしまいました・・・・
```

image::kato/8/09.jpg[]

マニュアルのサイズと少しサイズが違う（！）ので、マニュアルのサイズに合わせるよりも歪みが少なくなる事を優先して組み立てます。

image::kato/8/10.jpg[]

２つ目の枠を作ります。 +
頑張って調整しても歪みが出ます。

image::kato/8/11.jpg[]

台座を付けます。 +
台座のサイズがマニュアルより小さい・・・汗 +
でも、気にせず中央になるように組み立てていきます。

もちろん、スムーズには動きません！ +
ポイントとしては、ネジを締めすぎないようすることです。 +
台座がガタガタしなければOKかと思います。

image::kato/8/12.jpg[]

背の部分を付けます。
支えがプラスチックなため、完璧な90度にはなりません！

image::kato/8/13.jpg[]

ステッピングモーターをつけていきます。

image::kato/8/14.png[]

ドリル、コントローラー基板を付けて完成です。 +
できました！

image::kato/8/15.jpg[]


早速電源にをいれよう！ +
と思ったのですが、付属していたケーブルだと電源からすぐ抜けてしまいました。 +
よく見てみると、差し込みの部分に穴が空いていません！ +
(穴って重要だったんですね) +
仕方ないので、手持ちのケーブルで電源につなぎました。

image::kato/8/16.jpg[]


## Gコードデータを用意する

掘削するためには、Gコードと呼ばれるデータを用意する必要があります。

Gコードの生成には、InkscapeとそのGcodetoolsを使いました。

Draw Freely | Inkscape +
https://inkscape.org/ja/

User:BHSPitMonkey/Inkscape and Gcodetools Tutorial +
(Gcodetoolsの説明があるページ) +
https://www.shapeoko.com/wiki/index.php/User:BHSPitMonkey/Inkscape_and_Gcodetools_Tutorial


こんな感じで、データを作ります。

image::kato/8/17.png[]

「エクステンション」→「Gcodetools」→「Orientation points」からZ軸の掘削の深さ指定を行い、

image::kato/8/18.png[]

次に、「エクステンション」→「Gcodetools」→「Path to Gcode」でGcodeの生成を行います。
場合によっては、Preferencesタブから出力先を指定する必要があります。

image::kato/8/19.png[]

「Apply」ボタン押下で、それっぽいデータが出来上がりました。

image::kato/8/20.png[]



## 実際に掘削してみる

#### bCNCの準備

私は、普段Macで作業していますが、 +
とりあえず、Macでも動作し雰囲気も良さそうだったためbCNCを使ってみることにしました。

GitHub - vlachoudis / bCNC + 
https://github.com/vlachoudis/bCNC

事前にMacとCNC1610を接続しておきます。 +
bCNC起動後、それっぽいシリアルポートを選択し、「開く」をクリックします。 +
これで、bCNC上からCNC1610を制御出来るようになりました。

image::kato/8/21.png[]


次に、先程作ったGコードを読み込みます。 +
EditorタブのEditメニューからインポートを行います。

image::kato/8/22.png[]

すると、Gコードが左側に出てきます。 +
ここで、M3から始まる行は、ドリルの回転スピードですが、指定がなかったため「M3 S700」と変更しました。 +
回転スピードが早いと、結構うるさいです！！！ +
回転スピードを下げる場合、軸の移動速度や、1回で掘る深さなどの調整が必要そうなので、ここらへんは今後いい感じの設定を模索する事になりそうです。

image::kato/8/23.png[]

読み込むとこんな感じになります。 +
(黄色やピンクの枠線は表示されていないかもしれません)

image::kato/8/24.png[]


#### 生基板セット
掘削で使う素材を台座にセットします。 +
安全のため、電源を抜いた状態で作業するのが良いと思います。

私は、板の上に生基板を置く形にしてみました。 +
また、動かないように「穴の開いた金属の棒?(東急ハンズ渋谷店で購入)」で固定してみました。

image::kato/8/25.jpg[]

また、「生基板とモーター(ドリル部分と通電する場所)」と制御基板の「A5ピン」を繋いでおきます。 +
こうすることで、bCNCのAutolevel機能を使うことができます。 +
Autolevel機能とは、掘削対象の歪みを考慮して掘削してくれる機能です。 +
基板のように掘削の深さの正確さが求められるようなケースではありがたい機能です。 +
とくに、今回のCNC1610のように、そもそも歪んでいるマシンの場合、非常にありがたく必須の機能です。

image::kato/8/26.jpg[]


#### 原点調整

再度、CNC1610とbCNCを接続し、原点を決めます。 +
Control部分で左下部分に、ドリル刃の先端が来るように調整します。

image::kato/8/27.png[]

調整ができたら、「X=0」「Y=0」「Z=0」をクリックし、原点に設定します。

image::kato/8/28.png[]


ドリルの位置はこんな感じ。
(画像の使い回しですいません)

image::kato/8/25.jpg[]


#### Autolevel

Autolevel機能で、歪みを計測します。 +
メニューから「Probeタブ」「Autolevel」を選択します。 +
次に、左側のAutolevelのXYZ軸それぞれに対して、「Min」と「Max」「Step」を設定します。 +
設定が完了したら、メニューの「Scan」をクリックします。

Autolevelの測定が動作している様子はこんな感じです。

++++
<iframe width="560" height="315" src="https://www.youtube.com/embed/RSo8akVMQ3E" frameborder="0" allowfullscreen></iframe>
++++

また、測定が完了すると、歪みが画面上に表示されます。 +
組み立てたCNCマシンは、結構歪んでいるようです。。。

image::kato/8/29.png[]


## いざ、掘削！

ここまでできれば、後はGコードの内容で掘削できます。 +
メニューのControleタブを開いて、「Start」をクリックします。



掘削が進んでいます。

image::kato/8/30.jpg[]

できました！

image::kato/8/31.jpg[]

動作している様子はこんな感じです。 +
どこまで進んでいるのかリアルタイムで確認できて、いい感じです♪

++++
<iframe width="560" height="315" src="https://www.youtube.com/embed/K4EgaISKc3A" frameborder="0" allowfullscreen></iframe>
++++


#### 結果
削りカスを取ってみました。 +
黒くなっている部分は、生基板の金属部分が全て削れた場所です。

image::kato/8/32.jpg[]

拡大すると、こんな感じ。

image::kato/8/33.png[]

ロゴの横幅は、約4.5cmです。 +
こう見ると、Autolevelを行ったものの、歪みが出ているようです。 +
とはいえ、送料込で約20,000円程度のCNCと考えれば、満足です。 +
CNCマシンの調整進めれば、もう少しは精度を上げることが出来そうです。


## まとめ

今回は、CNC1610の検証をしてみました。 +
その結果、送料込みで約20,000円という価格、また組立時に歪みが出ていたので心配していましたが、 +
ちゃんと動作し、そここその精度で掘削が出来ることがわかりました。

また、複製コストがほぼ0のソフトウェアと違い、モノ作りはどうしても原価がかかります。 +
その点、今回のCNC1610には3Dプリンターで出力された精度の低いパーツが含まれていましたが、 +
徹底的に原価を下げるための戦略として納得し、参考になりました。

とりあえず、今回の検証でCNCでプロトタイプ用の基板をサクッと作れる目処はたったため、 +
ガシガシ色んな回路を組んで、基板を作って遊んで行く予定です。
